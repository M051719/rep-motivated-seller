$configPath = "supabase\config.toml"
$configContent = Get-Content $configPath -Raw

# Add or update edge_runtime section
if ($configContent -notmatch '\[edge_runtime\]') {
    $configContent += @'

[edge_runtime]
enabled = true
policy = "per_worker"
inspector_port = 8083
'@
} else {
    $configContent = $configContent -replace '\[edge_runtime\][\s\S]*?(?=\[|\z)', @'
[edge_runtime]
enabled = true
policy = "per_worker"
inspector_port = 8083

'@
}

Set-Content -Path $configPath -Value $configContent -Encoding UTF8
Write-Host "âœ… Supabase config updated for edge functions" -ForegroundColor Green